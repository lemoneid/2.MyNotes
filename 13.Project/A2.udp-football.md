---
id : A2.udp-football
title : A2.udp-football
typora-root-url : ../
---



## 多人实时足球项目设计

### 技术点

线程：多线程，互斥锁，条件变量，线程池

信号：SIGINT，SIGALARM，间隔定时器

IO：文件打卡，文件读写，非阻塞IO，IO多路复用，Select，Epoll

网络：TCP，UDP，SOCKET

### 界面

![image-20210916103201059](/Image/A2.udp-football-photo/image-20210916103201059.png)



### 整体框架

1. 本游戏是一个基于UDP网络编程的C/S架构的应用，需要独立完成server和client两端；
2. 玩游戏时，玩家启动cllent端，选择自己的队伍，登录server后，在球场外等待，之后自主进入球场，开始游戏；
3. 游戏过程中，由server端接收client的控制信息，决定玩家的移动，踢球，带球等游戏行为，再将游戏实时信息发送给所有客户端：
4. 玩家可以在游戏端发送聊天信息到客户端，同时也可以收到其他玩家的信息，当然也可以发送私聊信息给某位玩家

### 功能说明

1. 操作：
   - space打开力度条，再次按下选中力度1停球
   - k普通力度踢球1带球
   - n显示球员姓名
   - enter打开输入框，输入聊天信息
   2．移动
   - w向上移动
   - s向下移动 
   - a向左移动
   - d向右移动
3. 规则判断：
   - 出界，直接在出界位置由对方球员发球
   - 进球，直接在球门前由守门员开球

### 详细说明
#### 服务端
1. 启动
   - 启动时默认读取配置文件，获取端口port，游戏地图大小等参数
   - 同样也可以在启动时，通过指定选项，若指定选项，则配置文件中的配置不生效。主线程
2. 并发设置
   - 主线程
      - 主线程是一个acceptor ，循环等待用户登录，登录后将用户按照队伍不同加到各自从反应堆中
      - 在主线程中，开启定时器，注册时钟信号处理函数，收到时钟信号，向c11ent发送游戏数据
      - 主线程中注册sigint信号处理函数，收到ctrl + c时，告知客户端下线，结束运行

   - 子线程
      - 两个子线程，每一个对应着一个队伍
      - 该线程为从反应堆，使用epol1等待用户控制信息，收到控制信息后，更新游戏数据

客户端 

1. 启动 
- 启动时读取配置文件，获取服务端的ip，port等信息，获取玩家用户名，队伍
- 启动时也可以指定选项，若指定选项，则配置文件中的配置不生效

2. 并发设置 
   - 主线程
     - 主线程向 server 发送登录信息，若收到响应，则成功登录，否则退出运行
     - 主线程中注册 sigint 信号处理函数，收到ctrl＋c时，告知server 下线，结束运行
     - 主线程负责接收键盘输入，判断游戏行为。子线程
   - 子线程
     - 负责收服务端广播的信息，并做出解析
     - 重绘游戏界面

### 接口集合

